{% extends "base.html" %}
{% block content %}
<h2>Distance Sensors</h2>

<div class="card p-3 shadow">
  <h4>Sensor 1 Distance: <span id="sensor1">--</span> cm (Max: <span id="sensor1_max">0</span> cm)</h4>
  <canvas id="sensor1Chart" width="800" height="300"></canvas>
</div>

<div class="card p-3 shadow mt-3">
  <h4>Sensor 2 Distance: <span id="sensor2">--</span> cm (Max: <span id="sensor2_max">0</span> cm)</h4>
  <canvas id="sensor2Chart" width="800" height="300"></canvas>
</div>

<!-- ðŸ”” Buzzer Indicator -->
<div class="card p-3 shadow mt-3 text-center">
  <h4>Buzzer Status</h4>
  <div id="buzzer" class="buzzer-off" style="font-size: 3rem;">ðŸ””</div>
</div>

<a href="/" class="btn btn-secondary mt-3">â¬… Back to Dashboard</a>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  .buzzer-off { color: gray; transition: color 0.3s ease; }
  .buzzer-on  { color: red; animation: buzzer-blink 1s infinite; }
  @keyframes buzzer-blink {
    0%, 50%, 100% { opacity: 1; }
    25%, 75% { opacity: 0.3; }
  }
</style>

<script>
async function updateData() {
  try {
    const response = await fetch("http://<raspi-ip>:5000/data"); // Pi's Flask endpoint
    const data = await response.json();

    document.getElementById("s1").innerText = data.sensor1 + " cm";
    document.getElementById("s2").innerText = data.sensor2 + " cm";
    document.getElementById("status").innerText = data.buzzer ? "Buzzer ON" : "Buzzer OFF";

  } catch (err) {
    console.error("Error fetching sensor data:", err);
  }
}

setInterval(updateData, 2000); // refresh every 2 sec
</script>

{% endblock %}
